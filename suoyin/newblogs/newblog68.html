<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <link href="../../maychangecss/newblog_nomal.css" type="text/css" rel="stylesheet">
  <title>【LODOP】打印不清晰（提高打印清晰度）（文案，初）</title>
 </head>
 <body>
 <style>
 body{margin:0px;}
.body {width:100%;}
a{text-decoration:none;color:black;}
h1{font-size:1.625em;}
h2{font-size:1.375em;}
/**.box{float:left;}**/
.header_box {width:100%;}
.header{padding:1%;
background-color:#f1f1f1;}
/**border:1px solid #e9e9e9;}**/

.header_bottom{width:100%;}
.menuitem {
    margin-top:0;
    margin-left:0;
    margin-bottom:0;
    padding:1%;
    border-bottom:1px solid #e9e9e9;
    cursor:pointer;
}

.main {padding:1%;}
.main_middle { width:100%;}
.blue{color:#95bfc7;}


.box_footer {width:100%;margin-bottom:0;}
.footer {
    padding:1%;
    text-align:center;
    background-color:#f1f1f1;
    font-size:0.625em;
}

@media only screen and (max-width: 500px) {
    .menu_left{width:100%;}
    .menuitem { margin:1%;padding:1%;}

    .main_middle { width:100%;}
    .main {padding:1%;}

    .box_right {width:100%;}
    .right { padding:1%;
    }

    .box { margin-right:0; float:left; }
}

</style>
<div class="body"><!--body开始-->
        <div class="box header_box"><!--header开始-->
            <div class="header">
                <h1>博文-【LODOP】打印不清晰（提高打印清晰度）（文案，初）</h1>
            </div>
        </div><!--header结束-->
<div class="header_bottom"> 
		   <a href="../../index.html"><div class="menuitem">花谢悦神的主页</div></a>	
		   <a href="../phoneQA004.html"><div class="menuitem">lodop问答主页</div></a> 
		   <a href="../phoneQA_dange.html"><div class="menuitem">问答主页（单个问答链接）</div></a> 
		   <a href="../mini_QAs.html"><div class="menuitem"><span style="color:#ff0099;">迷你一个问答</span></div></a> 
		   <a href="../new_bloglist.html"><div class="menuitem"><span class="newblogfont">新博文newblogs</span></div></a>
</div>
        <div class="box main_middle"><!--main_middle开始-->
            <div class="main">
<h1>【LODOP】打印不清晰（提高打印清晰度）（文案，初）</h1>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>1.ADD_PRINT_TEXT纯文本不清晰</p>
<p>ADD_PRINT_TEXT纯文本，这个是lodop语句输出的文本，比较清晰的，</p>
<p>没有其他提高清晰度的方法，如果打印机打印纯文本不清晰，排查打印机或打印机驱动问题。</p>
<p>（1）提高打印机精度，调整打印机精度，重装打印机驱动，排查打印机问题</p>
<p>（2）文本加粗，换成更粗的文本样式，字体黑色等</p>
<p>（3）排查语句是否有缩放，缩放会导致内容有变形</p>
<p>2.ADD_PRINT_HTML超文本不清晰</p>
<p>（1）使用了ADD_PRINT_HTML 语句</p>
<p>如果用的是ADD_PRINT_HTML ，换成 ADD_PRINT_HTM试试，这种是解析后的超文本</p>
<p>ADD_PRINT_HTML是图形模式，而ADD_PRINT_HTM是解析后的超文本，比ADD_PRINT_HTML清晰</p>
<p>ps:ADD_PRINT_HTML能更好的还原页面样式，但不如ADD_PRINT_HTM清晰，适合高精度的打印机，两者各有优势。</p>
<p>ADD_PRINT_TABLE和ADD_PRINT_HTM都是解析后的超文本，只有ADD_PRINT_HTML这个语句是图形模式。</p>
<p>（2）排查语句是否有缩放，缩放会导致内容有变形</p>
<p>3.ADD_PRINT_HTM或ADD_PRINT_TABLE不清晰</p>
<p>这个输出的是解析后的超文本，是比较清晰的，没有其他提高清晰度的方法了。</p>
<p>（1）提高打印机精度，调整打印机精度，重装打印机驱动，排查打印机问题</p>
<p>（2）文本加粗，换成更粗的文本样式，字体黑色等</p>
<p>（3）排查语句是否有缩放，缩放会导致内容有变形</p>
<p>3.ADD_PRINT_HTM内部的图片不清晰</p>
<p>ADD_PRINT_HTM内部的图片没有提高清晰的方法，如果想进一步提高清晰度，需要单独输出图片</p>
<p>如何输出清晰图片 参考http://www.c-lodop.com/faq/pp14.html<br />单独语句输出，不要在img标签里缩放，用lodop语句缩放</p>
<p><br />提高打印普通图片质量<br />        （1）首先要用ADD_PRINT_IMAGE语句打印图片，而且img元素的width和height属性要去掉或者设置足够大，这样就可以让下载引擎传给Lodop图片质量足够好;<br />        其次如果要控制图片输出大小，要用SET_PRINT_STYLEA(0,"Stretch",1)语句控制最终输出大小（参考样例8）。<br />根据样例8代码如下：红色是原图片宽度和高度的设置，绿色字体是实际输出图片的大小（根据第二条可变形语句控制缩放到合适的大小）<br />LODOP.ADD_PRINT_IMAGE(30,20,100,100,"&lt;img border='0' src='http://s1.sinaimg.cn/middle/4fe4ba17hb5afe2caa990&amp;690' width=500 height=500 /&gt;");<br />LODOP.SET_PRINT_STYLEA(0,"Stretch",1);//(可变形)扩展缩放模式</p>
<p>        （2）采用C-Lodop6.569及上版本，图片来源参数不用img标签，而是直接用URL地址，例如：<br />LODOP.ADD_PRINT_IMAGE(0,0,"210mm","296.99mm","http://www.c-lodop.com/demolist/PrintSample8.jpg");<br />        （3）直接输出base64码，参考样例38。</p>
<p>不加img标签，不经过浏览器解析，且需要缩放时，用lodop语句缩放：</p>
<p>安装最新版c-lodop，不加img标签，不经过浏览器解析<br />ADD_PRINT_IMAGE直接输出http的URL方式测试下，不加img标签。<br />例如：<br />LODOP.ADD_PRINT_IMAGE(0,0,"210mm","296.99mm","http://www.c-lodop.com/demolist/PrintSample8.jpg");<br />或参考样例38，直接输出base64码，不加img标签，不经过浏览器解<br />析,http://www.c-lodop.com/demolist/PrintSample38.html</p>
<p>4.单独输出图片，且不加img标签，lodop语句缩放（或未缩放），不清晰</p>
<p>没有其他提高清晰度的方法了</p>
<p>（1）提高打印机精度，调整打印机精度，重装打印机驱动，排查打印机问题</p>
<p>特殊情况（他人反馈）：手写姓名，签名图片不清晰，单独输出也不清晰<br />解决方法：增加了签名笔触大小</p>
<p><br />5.预览不清晰</p>
<p>实际打印测试下，预览是缩略图，以实际打印效果为准<br />如果没有打印机，可以安装虚拟打印机打印测试</p>
<p><br />排查清晰度是否和打印机有关：</p>
<p>用xps或pdf虚拟打印机测试下，<br />win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机</p>
<p>用xps或pdf虚拟打印机直接打印查看下效果，查看下虚拟打印机直接打印生成的文件。</p>
<p>ps：或换其他打印机测试，例如激光打印机，<br />激光打印机和针式打印机等打印机清晰度可能存在差异</p>
<p>6.二维码，条码图片，svg或canvas不清晰</p>
<p>如何输出清晰图片 参考http://www.c-lodop.com/faq/pp14.html<br />或参考样例11 http://www.c-lodop.com/demolist/PrintSample11.html，lodop语句输出二维码</p>
<p>样例11是lodop语句输出二维码条码，比较清晰</p>
<p>7.add_print_pdf，pdf打印项内部条码或二维码不清晰</p>
<p>pdf内部尽量条码内部用矢量画线组，不用图片。</p>
<p>8.add_print_pdf，pdf打印项内部条码或二维码模糊连在一起了（汉印或快麦热敏打印机）</p>
<p>那个不是联翩了，而是放大放宽了，超出的部分没打出来，应该是该打印机句柄获取不到，定位的打印机分辨率和别人的软件不一致，这是个老问题了，建议升级下打印机驱动，特别是适配操作系统版本的打印机驱动。</p>
<p>这个是打印机问题，定位的打印机分辨率和别人的软件不一致<br />建议升级下打印机驱动试试，特别是适配操作系统版本的打印机驱动。</p>
<p>ps:此问题虚拟打印机，和激光打印机等其他打印机表现是正常的，只有个别打印机有问题</p>
<p>其他，清晰度较高：<br />换用纯文本画线，能提高速度和清晰度，<br />纯文本不受浏览器解析影响，样式固定：<br />如果有二维码条码，用样例11方式输出<br />图片直接输出URL或base64，不加img标签</p>
<p>快递单，小票，标签，票据等，建议用ADD_PRINT_TEXT等纯文本和画线等进行设计，不受浏览器解析的影响。<br />参考http://www.c-lodop.com/demolist/PrintSample4.html<br />参考http://www.lodop.net/demolist/PrintSample18.html<br />画线输出表格，参考http://www.c-lodop.com/demolist/PrintSampleA1.html</p>
<p><br />其他：<br />缩放语句，和整页旋转（当前页面旋转）等也会损失清晰度<br />如遇到问题，可以去掉缩放或旋转对比下效果</p>
<p>更换实现方法：整页旋转可以替换为每个打印项单独旋转</p>
</div>
<p>&nbsp;</p>
</div>
</div>
    </div><!--main_middle结束-->

        <div class="box box_footer"><!--box_footer开始-->
            <div class="footer">
<p>lodop简短问答页面.</p>
            </div>
        </div><!--box_footer结束-->
</div><!--body结束-->
 </body>
</html>
