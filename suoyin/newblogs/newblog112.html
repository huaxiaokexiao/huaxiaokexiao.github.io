<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <link href="../../maychangecss/newblog_nomal.css" type="text/css" rel="stylesheet">
  <title>【LODOP】一进入页面就获取打印机列表（newblog112）（文案，初）</title>
 </head>
 <body>
 <style>
 body{margin:0px;}
.body {width:100%;}
a{text-decoration:none;color:black;}
h1{font-size:1.625em;}
h2{font-size:1.375em;}
/**.box{float:left;}**/
.header_box {width:100%;}
.header{padding:1%;
background-color:#f1f1f1;}
/**border:1px solid #e9e9e9;}**/

.header_bottom{width:100%;}
.menuitem {
    margin-top:0;
    margin-left:0;
    margin-bottom:0;
    padding:1%;
    border-bottom:1px solid #e9e9e9;
    cursor:pointer;
}

.main {padding:1%;}
.main_middle { width:100%;}
.blue{color:#95bfc7;}


.box_footer {width:100%;margin-bottom:0;}
.footer {
    padding:1%;
    text-align:center;
    background-color:#f1f1f1;
    font-size:0.625em;
}

@media only screen and (max-width: 500px) {
    .menu_left{width:100%;}
    .menuitem { margin:1%;padding:1%;}

    .main_middle { width:100%;}
    .main {padding:1%;}

    .box_right {width:100%;}
    .right { padding:1%;
    }

    .box { margin-right:0; float:left; }
}

</style>
<div class="body"><!--body开始-->
        <div class="box header_box"><!--header开始-->
            <div class="header">
                <h1>博文-【LODOP】一进入页面就获取打印机列表（newblog112）（文案，初）</h1>
            </div>
        </div><!--header结束-->
<div class="header_bottom"> 
		   <a href="../../index.html"><div class="menuitem">花谢悦神的主页</div></a>	
		   <a href="../phoneQA004.html"><div class="menuitem">lodop问答主页</div></a> 
		   <a href="../phoneQA_dange.html"><div class="menuitem">问答主页（单个问答链接）</div></a> 
		   <a href="../mini_QAs.html"><div class="menuitem"><span style="color:#ff0099;">迷你一个问答</span></div></a> 
		   <a href="../new_bloglist.html"><div class="menuitem"><span class="newblogfont">新博文newblogs</span></div></a>
</div>
        <div class="box main_middle"><!--main_middle开始-->
            <div class="main">
<h1>【LODOP】一进入页面就获取打印机列表（newblog112）（文案，初）</h1>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>获取打印机列表，在样例5里有演示<br />http://www.c-lodop.com/demolist/PrintSample5.html<br />（图）</p>
<p><br />样例5的打印机列表是点击后开始调用，<br />clodop第一进入页面需要准备时间，如果是一进入页面就调用，加延迟，或等页面加载完成</p>
<p>参考http://www.c-lodop.com/demolist/PrintSample52.html<br />或参考样例52的打印机列表，页面加载后调用</p>
<p>样例5是点击单选按钮后，展示打印机列表：<br />先查看下样例5的获取打印机列表的方法，由于样例5演示内容较多，这里直接把关于打印机列表的复制出来，去掉其他部分。<br />（图）<br />可以看到，步骤是，先获取打印机个数，再循环获取打印机名称，再添加到那个下拉框里。</p>
<p>页面效果：<br />（图）(图）</p>
<p>几年前博文里用过onload里，但是自己测试下，现在不行，onload里还是没下载完，目前新版本提示是<br />&ldquo;网页还没下载完毕，请稍等一下再操作.&rdquo;<br />（图）（图）<br />测试了下之前博文这个，这个不行，会提示没下载完。</p>
<p>把c-lodop服务停止后，观察JS里情况，可以看到最新版有四个clodopFuncs.js的尝试，这个报错在四个clodopFuncs.js之前，没获取到clodopFuncs.js之前是获取不到LODOP对象的，获取打印机个数的这个方法就提示没定义，因为这时候还没获取到LODOP对象。<br />（图）</p>
<p>解决方法：<br />也可以参考之前的&ldquo;网页还没下载完毕，请稍等一下再操作.&rdquo;的相关视频。<br />加延迟或等c-lodop准备好。</p>
<p>setTimeout("CreatePrinterList()","500"); </p>
<p>（图）（图）<br />测试加延迟之后就可以了。</p>
<p>注意：<br />最新的lodopFuncs.js有四个clodopFuncs.js尝试，第一个访问不到会继续往下。<br />如果第一个ws的clodopFuncs.js的8000没访问到，还会继续尝试，还需要等待时间。<br />这个500毫秒如果等待不够，也会报错，可以加大延迟数值。</p>
<p>测试这个onload不行：<br />//window.onload=function(){	<br />//CreatePrinterList(); <br />//};</p>
<p>加延迟可以，如果还是提示，加大延迟时间：<br />setTimeout("CreatePrinterList()","500"); </p>
<p>function CreatePrinterList(){<br />	    if (document.getElementById('PrinterList').innerHTML!="") return;<br />		LODOP=getLodop(); <br />		var iPrinterCount=LODOP.GET_PRINTER_COUNT();<br />		for(var i=0;i&lt;iPrinterCount;i++){</p>
<p>   			var option=document.createElement('option');<br />   			option.innerHTML=LODOP.GET_PRINTER_NAME(i);<br />   			option.value=i;<br />			document.getElementById('PrinterList').appendChild(option);<br />		};	<br />	};</p>
<p><br />放onload里不行，新版会提示&ldquo;网页还没下载完毕，请稍等一下再操作.&rdquo;，<br />可加延迟处理，<br />相关视频 ：【LODOP】一进入页面就获取打印机列表 ：https://v.douyin.com/HoQCP1iLrig/</p>
</div>
<p>&nbsp;</p>
</div>
</div>
    </div><!--main_middle结束-->

        <div class="box box_footer"><!--box_footer开始-->
            <div class="footer">
<p>lodop简短问答页面.</p>
            </div>
        </div><!--box_footer结束-->
</div><!--body结束-->
 </body>
</html>
