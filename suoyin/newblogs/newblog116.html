<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <link href="../../maychangecss/newblog_nomal.css" type="text/css" rel="stylesheet">
  <title>【LODOP】自定义纸张名称，建立重命名纸张（newblog116）（文案，初）</title>
 </head>
 <body>
 <style>
 body{margin:0px;}
.body {width:100%;}
a{text-decoration:none;color:black;}
h1{font-size:1.625em;}
h2{font-size:1.375em;}
/**.box{float:left;}**/
.header_box {width:100%;}
.header{padding:1%;
background-color:#f1f1f1;}
/**border:1px solid #e9e9e9;}**/

.header_bottom{width:100%;}
.menuitem {
    margin-top:0;
    margin-left:0;
    margin-bottom:0;
    padding:1%;
    border-bottom:1px solid #e9e9e9;
    cursor:pointer;
}

.main {padding:1%;}
.main_middle { width:100%;}
.blue{color:#95bfc7;}


.box_footer {width:100%;margin-bottom:0;}
.footer {
    padding:1%;
    text-align:center;
    background-color:#f1f1f1;
    font-size:0.625em;
}

@media only screen and (max-width: 500px) {
    .menu_left{width:100%;}
    .menuitem { margin:1%;padding:1%;}

    .main_middle { width:100%;}
    .main {padding:1%;}

    .box_right {width:100%;}
    .right { padding:1%;
    }

    .box { margin-right:0; float:left; }
}

</style>
<div class="body"><!--body开始-->
        <div class="box header_box"><!--header开始-->
            <div class="header">
                <h1>博文-【LODOP】自定义纸张名称，建立重命名纸张（newblog116）（文案，初）</h1>
            </div>
        </div><!--header结束-->
<div class="header_bottom"> 
		   <a href="../../index.html"><div class="menuitem">花谢悦神的主页</div></a>	
		   <a href="../phoneQA004.html"><div class="menuitem">lodop问答主页</div></a> 
		   <a href="../phoneQA_dange.html"><div class="menuitem">问答主页（单个问答链接）</div></a> 
		   <a href="../mini_QAs.html"><div class="menuitem"><span style="color:#ff0099;">迷你一个问答</span></div></a> 
		   <a href="../new_bloglist.html"><div class="menuitem"><span class="newblogfont">新博文newblogs</span></div></a>
</div>
        <div class="box main_middle"><!--main_middle开始-->
            <div class="main">
<h1>【LODOP】自定义纸张名称，建立重命名纸张（newblog116）（文案，初）</h1>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>官网样例5有一个步骤4，可以建立新的纸张名称，<br />http://www.c-lodop.com/demolist/PrintSample5.html</p>
<p>4：用宽()高()进行 打印预览4的同时并建立名称为LodopCustomPage的自定义类型。<br /> 这种方式可以适应某些不能动态设置纸张大小的打印机，新建的纸张可用SET_PRINT_MODE重命名。</p>
<p>这里演示一下这个功能，和介绍一些可能出现的问题。<br />为了节省时间，这里直接放欢迎页面那里测试：<br />LODOP.SET_PRINTER_INDEX("Microsoft XPS Document Writer");		<br />LODOP.SET_PRINT_PAGESIZE(1,1100,2000,"CreateCustomPage");		<br />LODOP.PREVIEW();<br />（图）</p>
<p>SET_PRINT_PAGESIZE第2个和第3个参数，是纸张的自定义高度，最后一个参数是纸张名称。<br />但当最后一个参数为CreateCustomPage这个关键字时，这个语句就会创建一个名称为LodopCustomPage的自定义类型，在该打印机列表里查看，就可以查看到自定义纸张名称。<br />（图）</p>
<p>该语句执行后，在该打印机纸张列表里就会出现这个LodopCustomPage纸张，选这个新的纸张，进入预览查看下，可以看到，当前确实是之前自己自定义的纸张尺寸。<br />（图）<br />建议这个纸张后，就会在纸张列表出现，指定名称时，和自带的纸张名称一样，宽高为0可以指定。<br />LODOP.SET_PRINTER_INDEX("Microsoft XPS Document Writer");		<br />LODOP.SET_PRINT_PAGESIZE(1,0,0,"LodopCustomPage");		<br />LODOP.PREVIEW();</p>
<p>LodopCustomPage这个是默认名称，如何修改该纸张的名称？<br />LODOP.SET_PRINT_MODE("CREATE_CUSTOM_PAGE_NAME","我的纸张名");//对新建的纸张重命名<br />用该语句可以对纸张重命名<br />（图）<br />LODOP.SET_PRINTER_INDEX("Microsoft XPS Document Writer");		<br />LODOP.SET_PRINT_PAGESIZE(1,1100,2000,"CreateCustomPage");<br />LODOP.SET_PRINT_MODE("CREATE_CUSTOM_PAGE_NAME","白白");</p>
<p>设置后，刷新下页面（新添加的纸张，需要刷新，否则有缓存问题）<br />（图）<br />可以看到，该纸张重命名为&ldquo;白白&rdquo;了。<br />当再需要指定该纸张时，就可以用&ldquo;白白&rdquo;这个名字了</p>
<p>常见问题:<br />1.误认为CreateCustomPage这个参数这里，就是填自己想取的纸张名字。<br />CreateCustomPage是个关键字，如果想自定义一个名称纸张，直接用这个关键字，其他字符无效。<br />如果需要重命名纸张，加这句：LODOP.SET_PRINT_MODE("CREATE_CUSTOM_PAGE_NAME","我的纸张名");//对新建的纸张重命名</p>
<p>2.设置了自定义和名称纸张，预览却不是这个纸张？<br />和自定义宽高一样，这个自定义名称纸张也是需要打印机的支持，如果是打印机不支持的纸张尺寸，自然不能生效。此时，可以用虚拟打印机对比测试，如果虚拟打印机正常，就是该打印机对该尺寸的不支持。</p>
<p>先介绍一下自定义纸张不生效情况：<br />之前有相关视频介绍过打印机不支持自定义宽高情况：<br />（图）</p>
<p>SET_PRINT_PAGESIZE(intOrient,intPageWidth,intPageHeight,strPageName);<br />intPageWidth,intPageHeight这两个宽高设置具体参数，最后一个可以是空值</p>
<p>例如：<br />LODOP.SET_PRINT_PAGESIZE(1,1400,900,"");<br />这个就是自定义了一个宽高。</p>
<p>如何确认是否支持，可以通过预览查看实际效果：<br />可以直接在样例5步骤1里测试：<br />http://www.c-lodop.com/demolist/PrintSample5.html<br />（图）</p>
<p>预览可以切换打印机，测试支持情况，首先看看Microsoft XPS Document Writer这个xps虚拟打印机效果，是支持的，预览下方状态栏可以看到该纸张是生效的。<br />（图）</p>
<p>切换成这个联想M7400的真实打印机，可以看到下方的纸张宽度生效了，但是纸张高度和自己代码设置的纸张高度不同，纸张本身并没有生效。<br />（图）</p>
<p>这个自定义名称也是同样的道理，给该打印机加了这个自定义名称纸张，但如果打印机本身支持有问题，可能有的打印机会添加不成功，或不是该尺寸。<br />（这里指定这个Lenovo M7400 Printer，添加一个140X90的纸张，纸张名称为&lsquo;小白&rsquo;）<br />LODOP.SET_PRINTER_INDEX("Lenovo M7400 Printer");	<br />LODOP.SET_PRINT_PAGESIZE(1,1400,900,"CreateCustomPage");<br />LODOP.SET_PRINT_MODE("CREATE_CUSTOM_PAGE_NAME","小白");</p>
<p>测试结果：<br />Lenovo M7400 Printer添加不成功，<br />xps虚拟打印机可以成功<br />OKI MICROLINE 5200F+可以成功</p>
<p>（图）<br />OKI MICROLINE 5200F+是个针式打印机，这个打印机测试可以添加这个尺寸出纸张。<br />可见，并非只有虚拟打印机可以添加成功。<br />是否能添加成功自定义纸张名称和打印机本身有关，可以通过虚拟打印机对比测试。<br />且一些导出类pdf虚拟打印机支持的纸张较少，也会存在一些特殊自定义纸张不支持的情况。</p>
<p>如果本机有这个Microsoft XPS Document Writer，可以用这个对比。</p>
<p>真实打印机自定义纸张宽高无效，这个添加自定义纸张名称也无效，怎么办，但是就是需要这个纸张？<br />打印机的限制，没有很好的办法，只能换用支持的纸张名称或纸张尺寸。</p>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
</div>
</div>
    </div><!--main_middle结束-->

        <div class="box box_footer"><!--box_footer开始-->
            <div class="footer">
<p>lodop简短问答页面.</p>
            </div>
        </div><!--box_footer结束-->
</div><!--body结束-->
 </body>
</html>
