<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <link href="../../maychangecss/newblog_nomal.css" type="text/css" rel="stylesheet">
  <title>【LODOP】一个任务多个表格带各自的页眉页脚（关联序号）（文案，初）</title>
 </head>
 <body>
 <style>
 body{margin:0px;}
.body {width:100%;}
a{text-decoration:none;color:black;}
h1{font-size:1.625em;}
h2{font-size:1.375em;}
/**.box{float:left;}**/
.header_box {width:100%;}
.header{padding:1%;
background-color:#f1f1f1;}
/**border:1px solid #e9e9e9;}**/

.header_bottom{width:100%;}
.menuitem {
    margin-top:0;
    margin-left:0;
    margin-bottom:0;
    padding:1%;
    border-bottom:1px solid #e9e9e9;
    cursor:pointer;
}

.main {padding:1%;}
.main_middle { width:100%;}
.blue{color:#95bfc7;}


.box_footer {width:100%;margin-bottom:0;}
.footer {
    padding:1%;
    text-align:center;
    background-color:#f1f1f1;
    font-size:0.625em;
}

@media only screen and (max-width: 500px) {
    .menu_left{width:100%;}
    .menuitem { margin:1%;padding:1%;}

    .main_middle { width:100%;}
    .main {padding:1%;}

    .box_right {width:100%;}
    .right { padding:1%;
    }

    .box { margin-right:0; float:left; }
}

</style>
<div class="body"><!--body开始-->
        <div class="box header_box"><!--header开始-->
            <div class="header">
                <h1>博文-【LODOP】一个任务多个表格带各自的页眉页脚（关联序号）（文案，初）</h1>
            </div>
        </div><!--header结束-->
<div class="header_bottom"> 
		   <a href="../../index.html"><div class="menuitem">花谢悦神的主页</div></a>	
		   <a href="../phoneQA004.html"><div class="menuitem">lodop问答主页</div></a> 
		   <a href="../phoneQA_dange.html"><div class="menuitem">问答主页（单个问答链接）</div></a> 
		   <a href="../mini_QAs.html"><div class="menuitem"><span style="color:#ff0099;">迷你一个问答</span></div></a> 
		   <a href="../new_bloglist.html"><div class="menuitem"><span class="newblogfont">新博文newblogs</span></div></a>
</div>
        <div class="box main_middle"><!--main_middle开始-->
            <div class="main">
<h1>【LODOP】一个任务多个表格带各自的页眉页脚（关联序号）（文案，初）</h1>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>之前的视频提到过一个任务多个表格，每个表格带各自页眉页脚的情况，这种情况需要用到关联，这个视频单独介绍下这个情况。</p>
<p><br />首先介绍一个什么是关联，以及页眉页脚关联是什么效果：<br />下载中心lodop技术手册中的相关介绍，http://www.c-lodop.com/download.html<br />（图）</p>
<p>&ldquo;LinkedItem&rdquo;的值： 整数或字符型，字符型代表被关联项的项目名，整数代表被关联项的序号，如果是负数，代表当前对象的前几个对象，例如-1代表前一个对象，-2代表前面隔一个对象，使用-1时可以用同一个语句连续顺序关联一串对象。<br />内容项与别人关联后，会紧跟被关联者之后打印，位置和区域大小随被关联项而定，此时其Top和left不再是上边距和左边距，而是与关联项的间隔空隙及左边距偏移。<br />            如果关联者是页眉页脚对象，那么不会每页输出，仅与被关联对象同页输出。此时输出的位置与被关联对象的位置相对固定，也就是当上边距小于被关联对象的上边距时，那么其起点位置会与被关联者的上边线保持设计时的距离，否则与被关联对象的下边线保持设计时的距离。</p>
<p><br />下面用样例43，仔细介绍下页眉页脚关联自动分页的表格，跟着各自表格输出的效果：</p>
<p>该样例中有两个表格，两个表格带着各自的标题。和各自表格尾部跟着部分内容。</p>
<p>先介绍下标题部分，两个标题为：<br />第一个表格标题div1:销售发货单-01，颜色#0000FF蓝色<br />第二个表格的标题div4:销售发货单-02,颜色#FF0000红色<br />（图）（图）</p>
<p>两个自动分页的表格，这里两个表格都是div2，只是用来演示，实际中不同的单据会是不同的内容。<br />两个表格中间用LODOP.NewPageA();进行分隔，强制分页。</p>
<p>（NewPageA这个带A的，和NewPage分页的区分，在之前的其他视频里，这个带A的，前面打印项可以自动分页，适合前面是自动分页的打印项）</p>
<p>（图）</p>
<p>两个表格都设置为了页眉页脚项，且关联了各自的表格</p>
<p>LODOP.SET_PRINT_STYLEA(0,"ItemType",1);这句是页眉页脚项，每页输出，由于加了关联，就是跟着被关联项了，<br />也就是技术手册里提到的情况：<br />如果关联者是页眉页脚对象，那么不会每页输出，仅与被关联对象同页输出。</p>
<p>关联序号：</p>
<p>第一个标题关联了第一个表格，第一个表格在该任务中是第一个打印项，序号是1，所以关联1号打印项。</p>
<p>第二个标题关联了第二个表格，第二个表格在该任务中是第4个打印项，序号是4，所以关联4号打印项。</p>
<p>什么是打印项序号？<br />参考官网下载中心的LODOP技术手册SET_PRINT_STYLEA篇，第一个参数就是打印项序号的介绍<br />（图）</p>
<p>数字型时，表示是序号，以其增加的先后自然顺序为准，从1开始，所有打印对象都参与排序，包括超文本、纯文本、图片、图线、图表、条码等。</p>
<p>现在用图标注下两个表格打印项在样例43中的序号：</p>
<p>（图）</p>
<p>从INIT初始化开始，所有打印项参与排序，add开头的就是添加的打印项，第一个表格是第一个打印项<br />第二个表格是第四个打印项。</p>
<p>出现现象1：一个任务两个表格，中间强制分页，每个表格设置了各自的标题为页眉页脚，所有页数的页眉页脚都重叠了。</p>
<p>解决方法：各自的眉脚关联各自的表格，加关联。</p>
<p>出现现象2：只有第一个表格有标题页眉页脚，且第二个表格的标题页眉页脚也显示到第一个表格上，第一个表格重叠了两个标题页眉页脚，第二个表格没有任何标题或页眉页脚</p>
<p>解决方法：关联错误，都关联第一个表格了，排查关联序号</p>
<p>出现现象3：加了关联，没生效<br />对照样例43排查下，语句位置是否正常，<br />SET_PRINT_STYLEA，第一个参数，0代表紧跟着的上一个打印项，直接加在该打印项语句后面。<br />（关联到前面的某个打印项，前面必须存在这个打印项，不能关联该打印项后面的打印项）</p>
<p><br />样例43还演示了跟着表格的页脚，也是关联了表格，每个表格是各自的页脚</p>
<p>第一个表格的页脚是一个htm超文本打印项div3，关联第一个表格<br />第二个表格的页脚是一个ADD_PRINT_TEXT文本，关联第二个表格<br />（图）</p>
<p>效果可以看到各个表格带着各自的页脚，且页脚是跟着表格的，也就是技术手册里描述的：<br />内容项与别人关联后，会紧跟被关联者之后打印，位置和区域大小随被关联项而定，此时其Top和left不再是上边距和左边距，而是与关联项的间隔空隙及左边距偏移。</p>
<p>样例43，右键查看源码，以上就是样例43关于一个任务多个表格，每个表格自动分页自带页眉页脚的方法。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><br />如果序号为0，代表当前（最后加入的那个）数据项；如果序号是负数，代表前面加入的数据项，该值为前移个数偏移量。</p>
<p>&nbsp;</p>
<p>二、关联对象<br />关联是打印项之间定位的。 参考样例41，http://www.c-lodop.com/demolist/PrintSample41.html<br />一个内容关联别人后，其Top值不再是上边距，而是与被关联者的间隙距离,Left值也变为左边距相对偏离量。</p>
<p>样例41，后面两个text关联第一个table打印项，这样table打印项无论数据多少，数据如何变化，都会跟着这两个text<br />且这两个text和table之间的距离是顶边距15，左边距一个是50，一个是300<br />关联表格后，ADD_PRINT_TEXT的第一个参数就不是距离纸张顶边距了，第二个参数也不是距离纸张左边距了，都是相对于table这个打印项的偏移值。</p>
<p>代码：<br />图：1也可以<br />图：</p>
<p>样例演示的是text关联表格，跟着表格输出，当然也可以表格关联表格，两个表格顺序输出</p>
<p>例如改一下代码，两个表格，第二个表格跟着第一个表格，中间间隔10，</p>
<p>两个表格左边距相同，因为第二个表格关联了第一个表格，所以第二参数是相对于第一个表格的偏移量，而不是纸张的左边距，所以改成0，这样两个表格就可以左边距对齐了。</p>
<p>效果如图，第二个表格跟着第一个表格，中间间隔10<br />（图）</p>
<p>关联对象的其他作用：<br />见样例43，可以看到<br />每个发货单都用div2当主体表格，该表格因超出纸高被自动分页，其它带颜色的div分别作为它们的页眉页脚<br />用NewPageA对两个发货单进行了分页，眉脚对象与主体表格进行了关联</p>
<p>默认页眉页脚是每页输出，<br />但眉脚对象关联了各自的表格，这样每个页眉页脚项跟着表格输出。每个表格带着各自的眉角。<br />蓝色的是第一个表格的眉脚，红色的是第二个表格的眉脚。</p>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
</div>
</div>
    </div><!--main_middle结束-->

        <div class="box box_footer"><!--box_footer开始-->
            <div class="footer">
<p>lodop简短问答页面.</p>
            </div>
        </div><!--box_footer结束-->
</div><!--body结束-->
 </body>
</html>
